import{r as u,j as t}from"./chunk-D5HdQM_v.js";function ne({data:i,lines:c,width:Y,height:y=350,title:C,subtitle:L,yAxisLabel:g,xAxisLabel:F="Assessment Number",yRange:$,showGrid:H=!0,interpretation:D}){const[a,p]=u.useState({x:0,y:0,dataIndex:-1,visible:!1}),[V,G]=u.useState(800),v=u.useRef(null),j=u.useRef(null);if(u.useEffect(()=>{const e=()=>{if(v.current){const s=v.current.getBoundingClientRect();G(s.width)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),i.length===0)return null;const O=Y||V,R=i.flatMap(e=>c.map(s=>e.values[s.key]).filter(s=>s!==void 0)),b=$?.min??Math.min(...R,0),z=$?.max??Math.max(...R,100),k=[],P=5;for(let e=0;e<=P;e++){const s=b+(z-b)*(e/P);k.push(s)}const M=(e,s)=>`${typeof e=="number"?e%1===0?e.toString():e.toFixed(1):e}${s||""}`,N=Math.max(...k.map(e=>M(e,c[0]?.unit).length*7))+20,W=g?40:0,q=N+W+10,X=Math.max(...c.map(e=>e.label.length*6.5)),J=10,B=15,E=20,n={top:30,right:B+E+X+J+20,bottom:80,left:q},w=300,I=n.left+n.right,K=O-I,x=Math.max(w,K),T=x+I,l=y-n.top-n.bottom;if(x<w||l<=0)return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:C}),t.jsxs("p",{className:"text-gray-500 text-center py-8",children:["Chart area too small to display. Container needs at least ",w+I,"px width."]})]});const h=e=>e/(i.length-1)*x,f=e=>l-(e-b)/(z-b)*l,Q=e=>{if(!j.current)return;const s=j.current.getBoundingClientRect(),r=e.clientX-s.left-n.left,d=e.clientY-s.top-n.top;if(r<0||r>x||d<0||d>l){p(m=>({...m,visible:!1}));return}let o=-1,S=1/0;for(let m=0;m<i.length;m++){const ee=h(m),A=Math.abs(r-ee);A<S&&(S=A,o=m)}const _=i.length===1?60:Math.min(60,Math.abs(h(1)-h(0))*.3);o>=0&&S<=_?p({x:e.clientX-s.left,y:e.clientY-s.top,dataIndex:o,visible:!0}):p(m=>({...m,visible:!1}))},U=()=>{p(e=>({...e,visible:!1}))},Z=c.map(e=>{const s=i.map((r,d)=>{const o=r.values[e.key];return o===void 0?"":`${d===0?"M":"L"} ${h(d)} ${f(o)}`}).filter(Boolean).join(" ");return{...e,pathData:s}});return t.jsxs("div",{ref:v,className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:C}),L&&t.jsx("p",{className:"text-sm text-gray-600",children:L})]}),t.jsxs("div",{className:"relative flex justify-center overflow-x-auto",children:[t.jsxs("svg",{ref:j,width:T,height:y,className:"border rounded",onMouseMove:Q,onMouseLeave:U,children:[t.jsxs("g",{transform:`translate(${n.left}, ${n.top})`,children:[H&&k.map((e,s)=>t.jsxs("g",{children:[t.jsx("line",{x1:0,y1:f(e),x2:x,y2:f(e),stroke:"#e5e7eb",strokeWidth:1}),t.jsx("text",{x:-15,y:f(e),textAnchor:"end",dominantBaseline:"middle",fontSize:"12",fill:"#6b7280",children:M(e,c[0]?.unit)})]},s)),Z.map((e,s)=>t.jsx("g",{children:t.jsx("path",{d:e.pathData,fill:"none",stroke:e.color,strokeWidth:e.strokeWidth||2,strokeDasharray:e.strokeDasharray,style:{opacity:a.visible?.7:1,transition:"opacity 0.2s ease"}})},e.key)),i.map((e,s)=>t.jsxs("g",{children:[c.map(r=>{const d=e.values[r.key];if(d===void 0||r.pointRadius===0)return null;const o=a.visible&&a.dataIndex===s;return t.jsx("circle",{cx:h(s),cy:f(d),r:o?(r.pointRadius||3)+2:r.pointRadius||3,fill:r.color,stroke:o?r.color:"#ffffff",strokeWidth:o?3:1,className:"cursor-pointer",style:{opacity:a.visible?o?1:.4:.8,transition:"all 0.2s ease",filter:o?"drop-shadow(0 2px 4px rgba(0,0,0,0.2))":"none"}},r.key)}),t.jsx("circle",{cx:h(s),cy:f(e.values[c[0]?.key]||0),r:15,fill:"transparent",className:"cursor-pointer"})]},s)),a.visible&&a.dataIndex>=0&&t.jsx("line",{x1:h(a.dataIndex),y1:0,x2:h(a.dataIndex),y2:l,stroke:"#6b7280",strokeWidth:1,strokeDasharray:"3,3",opacity:.7}),t.jsx("line",{x1:0,y1:l,x2:x,y2:l,stroke:"#374151",strokeWidth:1}),t.jsx("line",{x1:0,y1:0,x2:0,y2:l,stroke:"#374151",strokeWidth:1}),t.jsx("text",{x:x/2,y:l+40,textAnchor:"middle",fontSize:"12",fill:"#374151",fontWeight:"medium",children:F}),g&&t.jsx("text",{x:-(N+W/2),y:l/2,textAnchor:"middle",fontSize:"12",fill:"#374151",fontWeight:"medium",transform:`rotate(-90, ${-(N+W/2)}, ${l/2})`,children:g})]}),t.jsxs("g",{transform:`translate(${n.left+x+15}, ${n.top})`,children:[t.jsx("rect",{x:-5,y:-5,width:B+E+X+10,height:Math.max(60,25+c.length*18),fill:"rgba(249, 250, 251, 0.95)",stroke:"#e5e7eb",strokeWidth:1,rx:4}),t.jsx("text",{x:5,y:10,fontSize:"12",fontWeight:"bold",fill:"#374151",children:"Legend"}),c.map((e,s)=>t.jsxs("g",{transform:`translate(5, ${25+s*18})`,children:[t.jsx("line",{x1:0,y1:0,x2:15,y2:0,stroke:e.color,strokeWidth:e.strokeWidth||2,strokeDasharray:e.strokeDasharray,style:{opacity:a.visible?.7:1,transition:"opacity 0.2s ease"}}),t.jsx("text",{x:20,y:4,fontSize:"11",fill:"#374151",style:{opacity:a.visible?.7:1,transition:"opacity 0.2s ease"},children:e.label})]},e.key))]})]}),a.visible&&a.dataIndex>=0&&t.jsxs("div",{className:"absolute text-white p-3 rounded-lg shadow-xl pointer-events-none z-10 min-w-48 backdrop-blur-sm border transition-all duration-200 ease-out",style:{backgroundColor:"rgba(17, 24, 39, 0.8)",borderColor:"rgba(75, 85, 99, 0.3)",backdropFilter:"blur(2px)",left:(()=>{const e=n.left+h(a.dataIndex),s=200,r=40,d=n.left+x/2;return e<d?Math.min(e+r,T-s-10):Math.max(e-s-r,10)})(),top:Math.max(20,Math.min(a.y-60,y-120))},children:[t.jsx("div",{className:"font-medium text-sm mb-2",children:i[a.dataIndex].xLabel}),t.jsxs("div",{className:"space-y-1 text-xs",children:[c.map(e=>{const s=i[a.dataIndex].values[e.key];return s===void 0?null:t.jsxs("div",{className:"flex justify-between items-center p-1 rounded transition-colors hover:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-0.5 rounded",style:{backgroundColor:e.color,boxShadow:"0 0 4px rgba(0,0,0,0.3)"}}),t.jsxs("span",{className:"font-medium",children:[e.label,":"]})]}),t.jsx("span",{className:"font-bold",style:{color:e.color},children:M(s,e.unit)})]},e.key)}),i[a.dataIndex].metadata&&t.jsx("div",{className:"border-t border-gray-700 pt-1 mt-2",children:Object.entries(i[a.dataIndex].metadata||{}).map(([e,s])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"capitalize",children:[e,":"]}),t.jsx("span",{children:String(s)})]},e))})]})]})]}),D&&t.jsx("div",{className:"mt-4 text-sm text-gray-600",children:t.jsxs("p",{children:[t.jsx("strong",{children:"Interpretation:"})," ",D]})})]})}export{ne as I};

import{r as m,j as e,i as F,o as z}from"../chunks/chunk-D5HdQM_v.js";/* empty css                      */import{L as y}from"../chunks/chunk-BjVEBXCY.js";import{I as k}from"../chunks/chunk-BffPLrkb.js";import"../chunks/chunk-CBikE94T.js";/* empty css                      */import"../chunks/chunk-qNf8tQrI.js";function L(){const[o,x]=m.useState([]),[p,c]=m.useState([]),[n,g]=m.useState(""),[s,u]=m.useState("all"),[i,N]=m.useState(null),[w,R]=m.useState([]);m.useEffect(()=>{const t=JSON.parse(localStorage.getItem("qbcheck-saved-runs")||"[]");t.sort((h,v)=>new Date(h.completedAt).getTime()-new Date(v.completedAt).getTime()),x(t);const l=new URLSearchParams(window.location.search),r=l.get("name"),d=l.get("type");r&&g(r),d&&["all","practice","assessment"].includes(d)&&u(d)},[]),m.useEffect(()=>{let t=[...o];if(n.trim()&&(t=t.filter(l=>(l.personName?.toLowerCase()||"").includes(n.toLowerCase())||n.toLowerCase()==="anonymous"&&!l.personName)),s!=="all"&&(t=t.filter(l=>{const r=l.results.duration<300;return s==="practice"?r:!r})),c(t),t.length>0){const l=t.filter(a=>a.results.duration<300).length,r=t.length-l,d=t.map(a=>a.results.accuracy),h=t.map(a=>a.results.averageReactionTime),v=new Set(t.map(a=>a.personName||"Anonymous")).size,A=t.map(a=>new Date(a.completedAt)),D={start:new Date(Math.min(...A.map(a=>a.getTime()))).toLocaleDateString(),end:new Date(Math.max(...A.map(a=>a.getTime()))).toLocaleDateString()};N({totalRuns:t.length,practiceRuns:l,fullAssessments:r,averageAccuracy:d.reduce((a,j)=>a+j,0)/d.length,averageReactionTime:h.reduce((a,j)=>a+j,0)/h.length,bestAccuracy:Math.max(...d),worstAccuracy:Math.min(...d),fastestReaction:Math.min(...h),slowestReaction:Math.max(...h),uniqueUsers:v,dateRange:D});const C=t.map(a=>({date:new Date(a.completedAt).toISOString().split("T")[0],accuracy:a.results.accuracy,reactionTime:a.results.averageReactionTime,runType:a.results.duration<300?"practice":"assessment",personName:a.personName||"Anonymous",incorrectRate:a.results.incorrectResponses/a.results.totalShapes*100,missedRate:a.results.missedResponses/a.results.totalShapes*100,totalShapes:a.results.totalShapes}));R(C)}else N(null),R([])},[o,n,s]);const f=(t,l)=>{const r=new URLSearchParams;t&&r.set("name",t),l!=="all"&&r.set("type",l);const d=`${window.location.pathname}${r.toString()?"?"+r.toString():""}`;window.history.replaceState(null,"",d)},b=t=>{g(t),f(t,s)},P=t=>{u(t),f(n,t)},T=()=>{g(""),u("all"),f("","all")},S=()=>{const t=o.map(r=>r.personName).filter(Boolean);return[...new Set(t)].sort()};return o.length===0?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:e.jsx("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(y,{href:"/results",className:"text-blue-600 hover:text-blue-800 font-medium no-underline",children:"← Back to Results"})})})}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Data Available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You need at least one saved assessment to view aggregate data."}),e.jsx(y,{href:"/",className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium no-underline",children:"Start Assessment"})]})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{href:"/results",className:"text-blue-600 hover:text-blue-800 font-medium no-underline",children:"← Back to Results"}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Aggregate Data Analysis"})]}),e.jsx(y,{href:"/",className:"text-gray-600 hover:text-gray-800 no-underline",children:"Home"})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Name"}),e.jsx("input",{id:"name-filter",type:"text",value:n,onChange:t=>b(t.target.value),placeholder:"Enter name or 'anonymous'",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Assessment Type"}),e.jsxs("select",{id:"type-filter",value:s,onChange:t=>P(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"practice",children:"Practice Only"}),e.jsx("option",{value:"assessment",children:"Full Assessment Only"})]})]}),e.jsx("div",{className:"flex gap-2",children:(n||s!=="all")&&e.jsx("button",{onClick:T,className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Clear Filters"})}),e.jsxs("div",{className:"text-right text-sm text-gray-500",children:[p.length," of ",o.length," runs analyzed"]})]}),S().length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"Quick filters:"}),e.jsx("button",{onClick:()=>b("anonymous"),className:`px-2 py-1 text-xs rounded transition-colors ${n==="anonymous"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Anonymous"}),S().slice(0,8).map(t=>e.jsx("button",{onClick:()=>b(t),className:`px-2 py-1 text-xs rounded transition-colors ${n===t?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:t},t))]})})]}),i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Total Runs"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:i.totalRuns}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.practiceRuns," practice, ",i.fullAssessments," full"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Average Accuracy"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:[i.averageAccuracy.toFixed(1),"%"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Range: ",i.worstAccuracy.toFixed(1),"% -"," ",i.bestAccuracy.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Avg Reaction Time"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600 mt-2",children:[Math.round(i.averageReactionTime),"ms"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Range: ",Math.round(i.fastestReaction),"ms -"," ",Math.round(i.slowestReaction),"ms"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Time Period"}),e.jsx("p",{className:"text-sm font-bold text-gray-900 mt-2",children:i.dateRange.start}),e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["to ",i.dateRange.end]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.uniqueUsers," unique users"]})]})]}),e.jsx(M,{data:w}),e.jsx(U,{data:w})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No data matches your filters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your filters to see aggregate data."}),e.jsx("button",{onClick:T,className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Clear Filters"})]})]})]})}function M({data:o}){if(o.length===0)return null;const x=o.map((c,n)=>({x:n,xLabel:`Assessment ${n+1}`,values:{accuracy:c.accuracy,incorrectRate:c.incorrectRate,missedRate:c.missedRate},metadata:{type:c.runType==="practice"?"Practice":"Full Assessment",person:c.personName,date:c.date,totalShapes:c.totalShapes}})),p=[{key:"accuracy",label:"Accuracy",color:"#3b82f6",strokeWidth:3,pointRadius:4,unit:"%"},{key:"incorrectRate",label:"Incorrect Rate",color:"#ef4444",strokeWidth:2,strokeDasharray:"5,5",pointRadius:3,unit:"%"},{key:"missedRate",label:"Missed Rate",color:"#f97316",strokeWidth:2,strokeDasharray:"3,3",pointRadius:3,unit:"%"}];return e.jsx(k,{data:x,lines:p,title:"Performance Metrics Over Time",subtitle:"All metrics normalized as percentage of total shapes shown",yAxisLabel:"Percentage (%)",yRange:{min:0,max:100},interpretation:"Higher accuracy (blue line) is better. Lower incorrect (red dashed) and missed (orange dotted) rates indicate better performance. All metrics are normalized by total shapes shown, making them comparable across different assessment lengths."})}function U({data:o}){if(o.length===0)return null;const x=o.map((s,u)=>({x:u,xLabel:`Assessment ${u+1}`,values:{reactionTime:s.reactionTime},metadata:{type:s.runType==="practice"?"Practice":"Full Assessment",person:s.personName,date:s.date,accuracy:`${s.accuracy.toFixed(1)}%`,totalShapes:s.totalShapes}})),p=[{key:"reactionTime",label:"Reaction Time",color:"#ef4444",strokeWidth:2,pointRadius:4,unit:"ms"}],c=o.map(s=>s.reactionTime),n=Math.max(0,Math.min(...c)-50),g=Math.max(...c)+50;return e.jsx(k,{data:x,lines:p,title:"Reaction Time Over Time",subtitle:"Average reaction time for correct responses",yAxisLabel:"Time (ms)",yRange:{min:n,max:g},interpretation:"Lower reaction times generally indicate better sustained attention and faster processing speed. Practice sessions may show different patterns than full assessments due to their shorter duration."})}const E=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"})),H={serverOnlyHooks:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:z}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/results/aggregate/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:E}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:F}}};export{H as configValuesSerialized};

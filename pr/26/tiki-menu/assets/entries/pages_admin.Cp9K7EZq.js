import{r as j,u as le,j as e,R as X,g as ee,q as te,o as O,c as q,s as K,d as E,w as ae,a as S,b as ie,T as U,e as de,f as he,i as xe,h as ye,k as fe}from"../chunks/chunk-CjhEpRAy.js";import"../chunks/chunk-BmiVclYl.js";/* empty css                      *//* empty css                      */function be({onClose:o}){const[i,a]=j.useState(""),[t,s]=j.useState(""),[n,l]=j.useState(""),[c,u]=j.useState(!1),{login:x,loginWithGoogle:C}=le(),b=async y=>{y.preventDefault();try{l(""),u(!0),await x(i,t),o()}catch(N){l("Failed to log in. Please check your credentials."),console.error("Login error:",N)}finally{u(!1)}},h=async()=>{try{l(""),u(!0),await C(),o()}catch(y){l("Failed to log in with Google. Please try again."),console.error("Google login error:",y)}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"tiki-card p-8 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-readable-dark mb-6 text-center",children:"Admin Login"}),n&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:n}),e.jsxs("button",{onClick:h,disabled:c,className:"w-full mb-4 bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 flex items-center justify-center gap-3 font-medium",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),c?"Signing in...":"Sign in with Google"]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-[var(--tiki-parchment)] text-readable-dark",children:"Or continue with email"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-readable-dark mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:i,onChange:y=>a(y.target.value),required:!0,className:"w-full px-3 py-2 border-2 border-[var(--tiki-carved)] rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--tiki-jade)] focus:border-[var(--tiki-jade)] bg-white text-[var(--tiki-carved)]",style:{backgroundColor:"var(--tiki-cream)"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-readable-dark mb-1",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:t,onChange:y=>s(y.target.value),required:!0,className:"w-full px-3 py-2 border-2 border-[var(--tiki-carved)] rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--tiki-jade)] focus:border-[var(--tiki-jade)] bg-white text-[var(--tiki-carved)]",style:{backgroundColor:"var(--tiki-cream)"}})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:c,className:"flex-1 py-2 px-4 rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-[var(--tiki-jade)] disabled:opacity-50 text-white",style:{backgroundColor:"var(--tiki-jade)"},children:c?"Logging in...":"Login"}),e.jsx("button",{type:"button",onClick:o,className:"flex-1 py-2 px-4 rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-gray-400 text-[var(--tiki-carved)] border-2",style:{borderColor:"var(--tiki-carved)",backgroundColor:"var(--tiki-cream)"},children:"Cancel"})]})]})]})})}const ne=o=>{let i;const a=new Set,t=(x,C)=>{const b=typeof x=="function"?x(i):x;if(!Object.is(b,i)){const h=i;i=C??(typeof b!="object"||b===null)?b:Object.assign({},i,b),a.forEach(y=>y(i,h))}},s=()=>i,c={setState:t,getState:s,getInitialState:()=>u,subscribe:x=>(a.add(x),()=>a.delete(x))},u=i=o(t,s,c);return c},ve=(o=>o?ne(o):ne),we=o=>o;function Ce(o,i=we){const a=X.useSyncExternalStore(o.subscribe,X.useCallback(()=>i(o.getState()),[o,i]),X.useCallback(()=>i(o.getInitialState()),[o,i]));return X.useDebugValue(a),a}const je=o=>{const i=ve(o),a=t=>Ce(i,t);return Object.assign(a,i),a},Ne=(o=>je);class ke{categoriesCache=null;ingredientsCache=null;lastFetch=0;CACHE_TTL=5e3;generateCategoryId(i,a){const t=i.toLowerCase().replace(/[^a-z0-9]/g,"-");return a?`${a}_${t}`:`cat_${t}`}generateIngredientId(i,a){return`ing_${`${a}_${i}`.toLowerCase().replace(/[^a-z0-9]/g,"-")}`}async getAllCategories(i=!1){if(!i&&this.categoriesCache&&Date.now()-this.lastFetch<this.CACHE_TTL)return this.categoriesCache;const a=await ee(te(q(S,"categories"),O("level"),O("order"),O("name")));return this.categoriesCache=a.docs.map(t=>({id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate()||new Date,updatedAt:t.data().updatedAt?.toDate()||new Date})),this.lastFetch=Date.now(),this.categoriesCache}async getAllIngredients(i=!1){if(!i&&this.ingredientsCache&&Date.now()-this.lastFetch<this.CACHE_TTL)return this.ingredientsCache;const a=await ee(te(q(S,"ingredients"),O("order"),O("name")));return this.ingredientsCache=a.docs.map(t=>({id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate()||new Date,updatedAt:t.data().updatedAt?.toDate()||new Date})),this.lastFetch=Date.now(),this.ingredientsCache}clearCache(){this.categoriesCache=null,this.ingredientsCache=null,this.lastFetch=0}async getCategoryHierarchy(){const i=await this.getAllCategories(),a=await this.getAllIngredients(),t=new Map;a.forEach(u=>{const x=t.get(u.categoryId)||[];x.push(u),t.set(u.categoryId,x)});const s=new Map,n=new Map;i.forEach(u=>{if(s.set(u.id,u),u.parentId){const x=n.get(u.parentId)||[];x.push(u),n.set(u.parentId,x)}});const l=u=>{const x=s.get(u),C=(n.get(u)||[]).sort((h,y)=>h.order-y.order||h.name.localeCompare(y.name)).map(h=>l(h.id)),b=(t.get(u)||[]).sort((h,y)=>h.order-y.order||h.name.localeCompare(y.name));return{category:x,children:C,ingredients:b}};return i.filter(u=>!u.parentId).sort((u,x)=>u.order-x.order||u.name.localeCompare(x.name)).map(u=>l(u.id))}async getCategoryWithContents(i){const a=await this.getAllCategories(),t=await this.getAllIngredients(),s=a.find(c=>c.id===i);if(!s)throw new Error(`Category not found: ${i}`);const n=a.filter(c=>c.parentId===i).sort((c,u)=>c.order-u.order||c.name.localeCompare(u.name)),l=t.filter(c=>c.categoryId===i).sort((c,u)=>c.order-u.order||c.name.localeCompare(u.name));return{category:s,subcategories:n,ingredients:l}}async createCategory(i,a=null,t){const s=new Date,n=this.generateCategoryId(i,a);let l=[i.toLowerCase()],c=0;if(a){const C=(await this.getAllCategories()).find(b=>b.id===a);if(!C)throw new Error(`Parent category not found: ${a}`);l=[...C.path,i.toLowerCase()],c=C.level+1}const u={name:i,parentId:a,path:l,level:c,order:0,description:t||"",createdAt:s,updatedAt:s};return await K(E(S,"categories",n),u),this.clearCache(),n}async createIngredient(i,a,t,s,n,l){const c=new Date,u=this.generateIngredientId(a,t),C=(await this.getAllCategories()).find(h=>h.id===i);if(!C)throw new Error(`Category not found: ${i}`);const b={name:a,displayName:s||(t?`${a} (${t})`:a),categoryId:i,categoryPath:C.path,brand:t,available:!0,inStock:!0,description:n||"",order:0,...l!==void 0&&!isNaN(l)?{abv:l}:{},createdAt:c,updatedAt:c};return await K(E(S,"ingredients",u),b),this.clearCache(),u}async updateCategory(i,a){const t={...a,updatedAt:new Date};Object.keys(t).forEach(s=>{t[s]===void 0&&delete t[s]}),await K(E(S,"categories",i),t,{merge:!0}),this.clearCache()}async updateIngredient(i,a){const t={...a,updatedAt:new Date};Object.keys(t).forEach(s=>{t[s]===void 0&&delete t[s]}),"abv"in a&&(a.abv!==void 0&&!isNaN(a.abv)?t.abv=a.abv:t.abv=null),await K(E(S,"ingredients",i),t,{merge:!0}),this.clearCache()}async deleteCategory(i){const a=ae(S),t=await this.getAllCategories(),s=await this.getAllIngredients(),n=new Set([i]);let l=!0;for(;l;){l=!1;for(const c of t)c.parentId&&n.has(c.parentId)&&!n.has(c.id)&&(n.add(c.id),l=!0)}s.filter(c=>n.has(c.categoryId)).forEach(c=>a.delete(E(S,"ingredients",c.id))),n.forEach(c=>a.delete(E(S,"categories",c))),await a.commit(),this.clearCache()}async deleteIngredient(i){await ie(E(S,"ingredients",i)),this.clearCache()}async moveIngredient(i,a){const s=(await this.getAllCategories()).find(n=>n.id===a);if(!s)throw new Error(`Target category not found: ${a}`);await this.updateIngredient(i,{categoryId:a,categoryPath:s.path})}async moveCategory(i,a){const t=ae(S),s=await this.getAllCategories(),n=await this.getAllIngredients(),l=s.find(h=>h.id===i);if(!l)throw new Error(`Category not found: ${i}`);let c,u;if(a){const h=s.find(y=>y.id===a);if(!h)throw new Error(`Target parent category not found: ${a}`);c=[...h.path,l.name.toLowerCase()],u=h.level+1}else c=[l.name.toLowerCase()],u=0;t.update(E(S,"categories",i),{parentId:a,path:c,level:u,updatedAt:U.now()});const x=new Map,C=(h,y,N)=>{s.filter(k=>k.parentId===h).forEach(k=>{const p=[...y,k.name.toLowerCase()],I=N+1;x.set(k.id,{...k,path:p,level:I}),C(k.id,p,I)})};C(i,c,u),x.forEach((h,y)=>{t.update(E(S,"categories",y),{path:h.path,level:h.level,updatedAt:U.now()})});const b=new Set([i,...x.keys()]);n.filter(h=>b.has(h.categoryId)).forEach(h=>{const y=h.categoryId===i?{path:c}:x.get(h.categoryId);t.update(E(S,"ingredients",h.id),{categoryPath:y.path,updatedAt:U.now()})}),await t.commit(),this.clearCache()}async getTopLevelCategories(){return(await this.getAllCategories()).filter(a=>!a.parentId)}async updateIngredientAvailability(i,a){await this.updateIngredient(i,{available:a})}}const F=new ke;class Se{recipesCache=null;lastFetch=0;CACHE_TTL=5e3;async getAllRecipes(i=!1){if(!i&&this.recipesCache&&Date.now()-this.lastFetch<this.CACHE_TTL)return this.recipesCache;const a=await ee(te(q(S,"recipes"),O("category"),O("order"),O("name")));return this.recipesCache=a.docs.map(t=>({id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate(),updatedAt:t.data().updatedAt?.toDate()})),this.lastFetch=Date.now(),this.recipesCache}async getActiveRecipes(){return(await this.getAllRecipes()).filter(a=>a.active)}clearCache(){this.recipesCache=null,this.lastFetch=0}async createRecipe(i){const a=E(q(S,"recipes")),t=new Date,s={...i,createdAt:t,updatedAt:t};return await K(a,s),this.clearCache(),a.id}async updateRecipe(i,a){const t={...a,updatedAt:new Date};Object.keys(t).forEach(s=>{t[s]===void 0&&delete t[s]}),await de(E(S,"recipes",i),t),this.clearCache()}async deleteRecipe(i){await ie(E(S,"recipes",i)),this.clearCache()}async initializeRecipes(){const a=[{name:"Mai Tai",description:"The king of tiki drinks with aged rum, orgeat, and citrus",category:"Classic Tiki",ingredients:[{categoryId:"cat_rum_aged",amount:2,unit:"oz",notes:"Preferably Jamaican"},{customName:"Orgeat",amount:.5,unit:"oz"},{customName:"Orange Curacao",amount:.5,unit:"oz"},{customName:"Fresh Lime Juice",amount:1,unit:"oz"}],instructions:["Add all ingredients to shaker with ice","Shake well","Strain over crushed ice","Garnish with mint sprig and lime wheel"],strength:"strong",isSpecial:!0,active:!0,glassType:"Double rocks glass",garnish:["Mint sprig","Lime wheel"],servingSize:1,order:1},{name:"Zombie",description:"A potent blend of three rums and tropical juices",category:"Classic Tiki",ingredients:[{categoryId:"cat_rum_light",amount:1,unit:"oz"},{categoryId:"cat_rum_dark",amount:1,unit:"oz"},{categoryId:"cat_rum_overproof",amount:1,unit:"oz",notes:"151 proof"},{customName:"Pineapple Juice",amount:2,unit:"oz"},{customName:"Grenadine",amount:.5,unit:"oz"},{customName:"Angostura Bitters",amount:2,unit:"dash"}],instructions:["Combine all ingredients in shaker with ice","Shake vigorously","Strain into tall glass over crushed ice","Garnish with pineapple wedge and cherry"],strength:"strong",isBitter:!0,active:!0,glassType:"Zombie glass",garnish:["Pineapple wedge","Cherry"],servingSize:1,order:2},{name:"Navy Grog",description:"Traditional sailors' refreshment with a modern twist",category:"Classic Tiki",ingredients:[{categoryId:"cat_rum_dark",amount:1,unit:"oz"},{categoryId:"cat_rum_light",amount:1,unit:"oz"},{customName:"Fresh Grapefruit Juice",amount:1,unit:"oz"},{customName:"Honey Syrup",amount:.5,unit:"oz"},{customName:"Fresh Lime Juice",amount:.5,unit:"oz"},{customName:"Allspice Dram",amount:.25,unit:"oz"}],instructions:["Shake all ingredients with ice","Strain over crushed ice in a double rocks glass","Garnish with lime wheel"],strength:"medium",active:!0,glassType:"Double rocks glass",garnish:["Lime wheel"],servingSize:1,order:3},{name:"Blue Hawaii",description:"Azure waves of coconut and pineapple bliss",category:"Tropical Paradise",ingredients:[{categoryId:"cat_vodka",amount:1.5,unit:"oz"},{customName:"Blue Curacao",amount:.5,unit:"oz"},{customName:"Pineapple Juice",amount:2,unit:"oz"},{customName:"Coconut Cream",amount:1,unit:"oz"}],instructions:["Blend all ingredients with ice","Pour into hurricane glass","Garnish with pineapple wedge and umbrella"],strength:"medium",active:!0,glassType:"Hurricane glass",garnish:["Pineapple wedge","Cocktail umbrella"],servingSize:1,order:1},{name:"PiÃ±a Colada",description:"Creamy coconut and pineapple perfection",category:"Tropical Paradise",ingredients:[{categoryId:"cat_rum_light",amount:2,unit:"oz"},{customName:"Coconut Cream",amount:2,unit:"oz"},{customName:"Pineapple Juice",amount:3,unit:"oz"},{customName:"Crushed Ice",amount:1,unit:"cup"}],instructions:["Blend all ingredients until smooth","Pour into hurricane glass","Garnish with pineapple wedge and cherry"],strength:"light",active:!0,glassType:"Hurricane glass",garnish:["Pineapple wedge","Cherry"],servingSize:1,order:2},{name:"Painkiller",description:"Smooth sailing with rum, pineapple, and coconut",category:"Tropical Paradise",ingredients:[{categoryId:"cat_rum_dark",amount:2,unit:"oz"},{customName:"Pineapple Juice",amount:4,unit:"oz"},{customName:"Orange Juice",amount:1,unit:"oz"},{customName:"Coconut Cream",amount:1,unit:"oz"}],instructions:["Shake all ingredients with ice","Strain over ice in a hurricane glass","Dust with nutmeg and garnish with pineapple"],strength:"medium",active:!0,glassType:"Hurricane glass",garnish:["Pineapple wedge","Grated nutmeg"],servingSize:1,order:3},{name:"Volcano Bowl",description:"A flaming spectacle meant for sharing",category:"House Specials",ingredients:[{categoryId:"cat_rum_dark",amount:2,unit:"oz"},{categoryId:"cat_rum_light",amount:2,unit:"oz"},{categoryId:"cat_brandy",amount:1,unit:"oz"},{customName:"Pineapple Juice",amount:4,unit:"oz"},{customName:"Orange Juice",amount:2,unit:"oz"},{customName:"Grenadine",amount:1,unit:"oz"},{categoryId:"cat_rum_overproof",amount:.5,unit:"oz",notes:"For flaming",optional:!0}],instructions:["Mix all ingredients except overproof rum","Pour over ice in volcano bowl","Float overproof rum in center well","Ignite carefully (optional)","Serve with long straws"],strength:"strong",isSpecial:!0,active:!0,glassType:"Volcano bowl",servingSize:4,order:1},{name:"Scorpion Bowl",description:"Group adventure in a bowl",category:"House Specials",ingredients:[{categoryId:"cat_rum_light",amount:2,unit:"oz"},{categoryId:"cat_brandy",amount:1,unit:"oz"},{customName:"Orgeat",amount:1.5,unit:"oz"},{customName:"Orange Juice",amount:2,unit:"oz"},{customName:"Pineapple Juice",amount:2,unit:"oz"}],instructions:["Combine all ingredients over ice","Stir well","Serve in large bowl with multiple straws","Garnish with fresh fruits"],strength:"strong",isSpecial:!0,active:!0,glassType:"Scorpion bowl",garnish:["Orange slices","Pineapple wedges","Cherries"],servingSize:4,order:2},{name:"Virgin Colada",description:"All the tropical flavor, none of the rum",category:"Zero Proof",ingredients:[{customName:"Coconut Cream",amount:2,unit:"oz"},{customName:"Pineapple Juice",amount:4,unit:"oz"},{customName:"Crushed Ice",amount:1,unit:"cup"}],instructions:["Blend all ingredients until smooth","Pour into hurricane glass","Garnish with pineapple and cherry"],strength:null,active:!0,glassType:"Hurricane glass",garnish:["Pineapple wedge","Cherry"],servingSize:1,order:1},{name:"Tropical Sunset",description:"Layers of fruit juices creating a sunset in your glass",category:"Zero Proof",ingredients:[{customName:"Orange Juice",amount:2,unit:"oz"},{customName:"Pineapple Juice",amount:2,unit:"oz"},{customName:"Grenadine",amount:.5,unit:"oz"},{customName:"Lime Juice",amount:.5,unit:"oz"}],instructions:["Fill glass with ice","Pour orange and pineapple juice","Slowly add grenadine to create layers","Top with lime juice","Garnish with orange slice"],strength:null,active:!0,glassType:"Highball glass",garnish:["Orange slice"],servingSize:1,order:2}].map(t=>this.createRecipe(t));await Promise.all(a)}}const Y=new Se,Z="recipe-categories";class Ie{async getAllRecipeCategories(i=!1){try{const a=q(S,Z),t=te(a,O("order"),O("name")),n=(await ee(t)).docs.map(l=>{const c=l.data();return{id:l.id,name:c.name,description:c.description,order:c.order||0,active:c.active!==!1,createdAt:c.createdAt?.toDate()||new Date,updatedAt:c.updatedAt?.toDate()||new Date}});return i?n:n.filter(l=>l.active)}catch(a){throw console.error("Error fetching recipe categories:",a),new Error("Failed to fetch recipe categories")}}async createRecipeCategory(i,a,t){try{const s=U.now(),n=q(S,Z);if(t===void 0){const c=await this.getAllRecipeCategories(!0);t=Math.max(0,...c.map(u=>u.order))+1}return(await he(n,{name:i,description:a||"",order:t,active:!0,createdAt:s,updatedAt:s})).id}catch(s){throw console.error("Error creating recipe category:",s),new Error("Failed to create recipe category")}}async updateRecipeCategory(i,a){try{const t=E(S,Z,i);await de(t,{...a,updatedAt:U.now()})}catch(t){throw console.error("Error updating recipe category:",t),new Error("Failed to update recipe category")}}async deleteRecipeCategory(i){try{const a=E(S,Z,i);await ie(a)}catch(a){throw console.error("Error deleting recipe category:",a),new Error("Failed to delete recipe category")}}async initializeDefaultCategories(){try{if((await this.getAllRecipeCategories(!0)).length>0){console.log("Recipe categories already exist, skipping initialization");return}const a=[{name:"Classic Tiki",description:"Traditional tiki cocktails with time-tested recipes",order:1},{name:"Tropical Paradise",description:"Fresh and fruity cocktails with tropical flavors",order:2},{name:"House Specials",description:"Unique creations and signature drinks",order:3},{name:"Zero Proof",description:"Non-alcoholic tropical drinks and mocktails",order:4}],t=ae(S),s=q(S,Z);a.forEach(n=>{const l=E(s);t.set(l,{...n,active:!0,createdAt:U.now(),updatedAt:U.now()})}),await t.commit(),console.log("Default recipe categories initialized successfully")}catch(i){throw console.error("Error initializing default recipe categories:",i),new Error("Failed to initialize default recipe categories")}}async reorderCategories(i){try{const a=ae(S);i.forEach(({id:t,order:s})=>{const n=E(S,Z,t);a.update(n,{order:s,updatedAt:U.now()})}),await a.commit()}catch(a){throw console.error("Error reordering recipe categories:",a),new Error("Failed to reorder recipe categories")}}}const W=new Ie,Q=(o,i)=>{const a=new Map,t=new Map,s=new Map;o.forEach(c=>{if(a.set(c.id,c),c.parentId){const u=t.get(c.parentId)||[];u.push(c),t.set(c.parentId,u)}}),i.forEach(c=>{const u=s.get(c.categoryId)||[];u.push(c),s.set(c.categoryId,u)});const n=c=>{const u=a.get(c),x=(t.get(c)||[]).sort((b,h)=>b.order-h.order||b.name.localeCompare(h.name)).map(b=>n(b.id)),C=(s.get(c)||[]).sort((b,h)=>b.order-h.order||b.name.localeCompare(h.name));return{category:u,children:x,ingredients:C}};return o.filter(c=>!c.parentId).sort((c,u)=>c.order-u.order||c.name.localeCompare(u.name)).map(c=>n(c.id))},T=Ne()((o,i)=>({categories:[],ingredients:[],recipes:[],recipeCategories:[],categoryHierarchy:[],isLoadingIngredients:!1,isLoadingRecipes:!1,isLoadingRecipeCategories:!1,operationsInProgress:new Set,error:null,loadIngredientLibrary:async()=>{if(!i().isLoadingIngredients){o({isLoadingIngredients:!0,error:null});try{const[t,s]=await Promise.all([F.getAllCategories(!0),F.getAllIngredients(!0)]),n=Q(t,s);o({categories:t,ingredients:s,categoryHierarchy:n,isLoadingIngredients:!1})}catch(t){console.error("Error loading ingredient library:",t),o({isLoadingIngredients:!1,error:t instanceof Error?t.message:"Failed to load ingredient library"})}}},loadRecipes:async()=>{if(!i().isLoadingRecipes){o({isLoadingRecipes:!0,error:null});try{const t=await Y.getAllRecipes(!0);o({recipes:t,isLoadingRecipes:!1})}catch(t){console.error("Error loading recipes:",t),o({isLoadingRecipes:!1,error:t instanceof Error?t.message:"Failed to load recipes"})}}},loadRecipeCategories:async()=>{if(!i().isLoadingRecipeCategories){o({isLoadingRecipeCategories:!0,error:null});try{const t=await W.getAllRecipeCategories(!0);o({recipeCategories:t,isLoadingRecipeCategories:!1})}catch(t){console.error("Error loading recipe categories:",t),o({isLoadingRecipeCategories:!1,error:t instanceof Error?t.message:"Failed to load recipe categories"})}}},createIngredient:async(a,t)=>{const s=`create-ingredient-${a}`;try{i().startOperation(s),await F.createIngredient(a,t.name,t.brand,t.displayName,t.description,t.abv),await i().loadIngredientLibrary()}catch(n){console.error("Error creating ingredient:",n),o({error:n instanceof Error?n.message:"Failed to create ingredient"})}finally{i().endOperation(s)}},updateIngredient:async(a,t)=>{const s=`update-ingredient-${a}`;try{i().startOperation(s),o(l=>({ingredients:l.ingredients.map(c=>c.id===a?{...c,...t,updatedAt:new Date}:c)})),await F.updateIngredient(a,t);const n=i();o({categoryHierarchy:Q(n.categories,n.ingredients)})}catch(n){console.error("Error updating ingredient:",n),await i().loadIngredientLibrary(),o({error:n instanceof Error?n.message:"Failed to update ingredient"})}finally{i().endOperation(s)}},deleteIngredient:async a=>{try{o(s=>({ingredients:s.ingredients.filter(n=>n.id!==a)})),await F.deleteIngredient(a);const t=i();o({categoryHierarchy:Q(t.categories,t.ingredients)})}catch(t){console.error("Error deleting ingredient:",t),await i().loadIngredientLibrary(),o({error:t instanceof Error?t.message:"Failed to delete ingredient"})}},moveIngredient:async(a,t)=>{const s=`move-ingredient-${a}`;try{i().startOperation(s);const l=i().categories.find(u=>u.id===t);if(!l)throw new Error("Target category not found");o(u=>({ingredients:u.ingredients.map(x=>x.id===a?{...x,categoryId:t,categoryPath:l.path,updatedAt:new Date}:x)})),await F.moveIngredient(a,t);const c=i();o({categoryHierarchy:Q(c.categories,c.ingredients)})}catch(n){console.error("Error moving ingredient:",n),await i().loadIngredientLibrary(),o({error:n instanceof Error?n.message:"Failed to move ingredient"})}finally{i().endOperation(s)}},toggleIngredientAvailability:async a=>{const t=i().ingredients.find(s=>s.id===a);t&&await i().updateIngredient(a,{available:!t.available})},toggleIngredientStock:async a=>{const t=i().ingredients.find(s=>s.id===a);t&&await i().updateIngredient(a,{inStock:!t.inStock})},createCategory:async(a,t,s)=>{try{await F.createCategory(a,t,s),await i().loadIngredientLibrary()}catch(n){console.error("Error creating category:",n),o({error:n instanceof Error?n.message:"Failed to create category"})}},updateCategory:async(a,t)=>{try{await F.updateCategory(a,t),await i().loadIngredientLibrary()}catch(s){console.error("Error updating category:",s),o({error:s instanceof Error?s.message:"Failed to update category"})}},deleteCategory:async a=>{try{await F.deleteCategory(a),await i().loadIngredientLibrary()}catch(t){console.error("Error deleting category:",t),o({error:t instanceof Error?t.message:"Failed to delete category"})}},moveCategory:async(a,t)=>{try{await F.moveCategory(a,t),await i().loadIngredientLibrary()}catch(s){console.error("Error moving category:",s),o({error:s instanceof Error?s.message:"Failed to move category"})}},createRecipe:async a=>{try{await Y.createRecipe(a),await i().loadRecipes()}catch(t){console.error("Error creating recipe:",t),o({error:t instanceof Error?t.message:"Failed to create recipe"})}},updateRecipe:async(a,t)=>{const s=`update-recipe-${a}`;try{i().startOperation(s),o(n=>({recipes:n.recipes.map(l=>l.id===a?{...l,...t,updatedAt:new Date}:l)})),await Y.updateRecipe(a,t)}catch(n){console.error("Error updating recipe:",n),await i().loadRecipes(),o({error:n instanceof Error?n.message:"Failed to update recipe"})}finally{i().endOperation(s)}},deleteRecipe:async a=>{try{o(t=>({recipes:t.recipes.filter(s=>s.id!==a)})),await Y.deleteRecipe(a)}catch(t){console.error("Error deleting recipe:",t),await i().loadRecipes(),o({error:t instanceof Error?t.message:"Failed to delete recipe"})}},toggleRecipeActive:async a=>{const t=i().recipes.find(s=>s.id===a);t&&await i().updateRecipe(a,{active:!t.active})},createRecipeCategory:async(a,t,s)=>{try{await W.createRecipeCategory(a,t,s),await i().loadRecipeCategories()}catch(n){console.error("Error creating recipe category:",n),o({error:n instanceof Error?n.message:"Failed to create recipe category"})}},updateRecipeCategory:async(a,t)=>{const s=`update-recipe-category-${a}`;try{i().startOperation(s),o(n=>({recipeCategories:n.recipeCategories.map(l=>l.id===a?{...l,...t,updatedAt:new Date}:l)})),await W.updateRecipeCategory(a,t)}catch(n){console.error("Error updating recipe category:",n),await i().loadRecipeCategories(),o({error:n instanceof Error?n.message:"Failed to update recipe category"})}finally{i().endOperation(s)}},deleteRecipeCategory:async a=>{try{const t=i(),s=t.recipeCategories.find(l=>l.id===a);if(!s)throw new Error("Category not found");const n=t.recipes.filter(l=>l.category===s.name);if(n.length>0)throw new Error(`Cannot delete category. It is used by ${n.length} recipe(s).`);o(l=>({recipeCategories:l.recipeCategories.filter(c=>c.id!==a)})),await W.deleteRecipeCategory(a)}catch(t){console.error("Error deleting recipe category:",t),await i().loadRecipeCategories(),o({error:t instanceof Error?t.message:"Failed to delete recipe category"})}},initializeDefaultRecipeCategories:async()=>{try{await W.initializeDefaultCategories(),await i().loadRecipeCategories()}catch(a){console.error("Error initializing default recipe categories:",a),o({error:a instanceof Error?a.message:"Failed to initialize default recipe categories"})}},reorderRecipeCategories:async a=>{try{o(t=>({recipeCategories:t.recipeCategories.map(s=>{const n=a.find(l=>l.id===s.id);return n?{...s,order:n.order}:s}).sort((s,n)=>s.order-n.order)})),await W.reorderCategories(a)}catch(t){console.error("Error reordering recipe categories:",t),await i().loadRecipeCategories(),o({error:t instanceof Error?t.message:"Failed to reorder recipe categories"})}},clearError:()=>o({error:null}),reset:()=>o({categories:[],ingredients:[],recipes:[],recipeCategories:[],categoryHierarchy:[],isLoadingIngredients:!1,isLoadingRecipes:!1,isLoadingRecipeCategories:!1,operationsInProgress:new Set,error:null}),startOperation:a=>{o(t=>({operationsInProgress:new Set([...t.operationsInProgress,a])}))},endOperation:a=>{o(t=>{const s=new Set(t.operationsInProgress);return s.delete(a),{operationsInProgress:s}})},getCategoryById:a=>i().categories.find(t=>t.id===a),getIngredientById:a=>i().ingredients.find(t=>t.id===a),getIngredientsByCategory:a=>i().ingredients.filter(t=>t.categoryId===a),getCategoryPath:a=>{const t=i().categories,s=t.find(c=>c.id===a);if(!s)return"";const n=[];let l=s;for(;l;)n.unshift(l.name),l=l.parentId?t.find(c=>c.id===l.parentId):void 0;return n.join(" â€º ")},getRecipeCategoryById:a=>i().recipeCategories.find(t=>t.id===a)})),Ae=()=>T(o=>o.categories),ue=()=>T(o=>o.ingredients),ge=()=>T(o=>o.recipeCategories),Ee=()=>T(o=>o.categoryHierarchy),ze=()=>T(o=>o.operationsInProgress.size>0);function re({isOpen:o,onClose:i,title:a,children:t,size:s="md"}){if(!o)return null;const n={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"},l=c=>{c.target===c.currentTarget&&i()};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(4px)"},onClick:l,children:e.jsxs("div",{className:`bg-tiki-surface border border-tiki-carved rounded-lg w-full ${n[s]} max-h-[90vh] overflow-y-auto`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-tiki-carved",children:[e.jsx("h3",{className:"text-lg font-bold text-tiki-text",children:a}),e.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700 text-xl leading-none","aria-label":"Close modal",children:"Ã—"})]}),e.jsx("div",{className:"p-4",children:t})]})})}function Re(o){const i=[...o].sort((a,t)=>a.path.join("/").localeCompare(t.path.join("/")));return i.map(a=>{let t="";if(a.level>0){const c=i.filter(C=>C.parentId===a.parentId&&C.level===a.level),x=c.indexOf(a)===c.length-1;for(let C=1;C<=a.level;C++)if(C===a.level)t+=x?"â””â”€â”€Â ":"â”œâ”€â”€Â ";else{const b=a.path.slice(0,C),h=i.find(y=>y.level===C-1&&y.path.join("/")===b.slice(0,-1).join("/"));if(h){const y=i.filter(p=>p.parentId===h.parentId&&p.level===h.level),k=y.indexOf(h)===y.length-1;t+=k?"Â Â Â Â ":"â”‚Â Â Â "}else t+="Â Â Â Â "}}const s=i.some(c=>c.parentId===a.id),n=a.level===0&&s?"/":"",l=[...a.path].reverse().join(" ");return{id:a.id,label:t+a.name+n,backtrace:l,category:a}})}function me({availableIngredients:o=[],categories:i=[],onSelect:a,placeholder:t="Search...",className:s="",value:n="",onClear:l,showIngredients:c=!0,showCategories:u=!0,showCustom:x=!0}){const[C,b]=j.useState(n),[h,y]=j.useState(n),[N,k]=j.useState(!1),[p,I]=j.useState(-1),[A,z]=j.useState(null),L=j.useRef(null),R=j.useRef(null),$=T(g=>g.getCategoryPath),P=()=>{const g=[];return u&&i.length>0&&Re(i).forEach(d=>{g.push({type:"category",id:d.id,name:d.category.name,displayName:d.label,backtrace:d.backtrace,searchText:d.category.path.join(" ")+" "+d.category.name,category:d.category})}),c&&o.length>0&&o.forEach(r=>{const d=$(r.categoryId),v="    ".repeat(r.categoryPath.length);g.push({type:"ingredient",id:r.id,name:r.name,displayName:`${v}â””â”€â”€ ${r.displayName||r.name}`,searchText:`${d} ${r.name} ${r.brand||""} ${r.description||""}`.toLowerCase(),ingredient:r})}),g},D=(g=>{if(!g.trim()){const m=P();return x&&m.push({type:"custom",name:"Use Custom",displayName:"Use Custom",searchText:"use custom"}),m.slice(0,15)}const r=g.toLowerCase(),d=P(),v=d.filter(m=>m.searchText.toLowerCase().includes(r)||m.name.toLowerCase().includes(r)||m.displayName.toLowerCase().includes(r)?!0:m.type==="category"&&m.category?d.some(H=>H.category&&H.category.path.some(pe=>pe.toLowerCase()===m.category.name.toLowerCase())&&(H.searchText.toLowerCase().includes(r)||H.name.toLowerCase().includes(r)||H.displayName.toLowerCase().includes(r))):!1);return x&&v.push({type:"custom",name:g,displayName:`Use Custom: "${g}"`,searchText:"use custom"}),v.slice(0,15)})(C),J=g=>{const r=g.target.value;b(r),y(r),z(null),k(!0),I(-1)},_=g=>{a(g),z(g);const r=g.type==="category"&&g.backtrace?g.backtrace:g.type==="custom"?g.name:g.displayName;y(r),b(""),k(!1),I(-1)},V=()=>{A&&(b(A.name),y(A.name)),k(!0)},M=g=>{if(N)switch(g.key){case"ArrowDown":g.preventDefault(),I(r=>r<D.length-1?r+1:r);break;case"ArrowUp":g.preventDefault(),I(r=>r>0?r-1:-1);break;case"Enter":g.preventDefault(),p>=0&&D[p]&&_(D[p]);break;case"Escape":g.preventDefault(),k(!1),I(-1),L.current?.blur();break}},f=()=>{setTimeout(()=>{if(k(!1),I(-1),A){const g=A.type==="category"&&A.backtrace?A.backtrace:A.type==="custom"?A.name:A.displayName;y(g),b("")}},200)};j.useEffect(()=>{if(p>=0&&R.current){const g=R.current.children[p];g&&g.scrollIntoView({block:"nearest"})}},[p]),j.useEffect(()=>{b(n),y(n),z(null)},[n]);const w=g=>{switch(g.type){case"ingredient":return"ðŸ§ª";case"category":return"ðŸ“";case"custom":return"âœï¸";default:return""}};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:L,type:"text",value:h,onChange:J,onKeyDown:M,onFocus:V,onBlur:f,placeholder:t,className:`w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${l&&C?"pr-8":""} ${s}`,autoComplete:"off"}),l&&(A||h)&&e.jsx("button",{type:"button",onClick:()=>{b(""),y(""),z(null),l()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"Ã—"}),N&&D.length>0&&e.jsx("div",{ref:R,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-80 overflow-y-auto",children:D.map((g,r)=>e.jsx("button",{type:"button",onClick:()=>_(g),className:`w-full text-left px-3 py-2 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none transition-colors ${r===p?"bg-blue-50 border-l-4 border-blue-500":""}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 truncate",children:[e.jsx("span",{className:"mr-2",children:w(g)}),g.displayName]}),g.ingredient&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:[g.ingredient.brand&&e.jsx("span",{className:"truncate",children:g.ingredient.brand}),g.ingredient.abv&&e.jsxs("span",{className:"bg-orange-100 text-orange-700 px-2 py-0.5 rounded text-xs",children:[g.ingredient.abv,"%"]}),!g.ingredient.available&&e.jsx("span",{className:"bg-red-100 text-red-700 px-2 py-0.5 rounded text-xs",children:"Unavailable"}),!g.ingredient.inStock&&e.jsx("span",{className:"bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded text-xs",children:"Out of Stock"})]}),g.category&&g.category.description&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",children:g.category.description})]})})},`${g.type}-${g.id||g.name}-${r}`))}),N&&C.length>0&&D.length===0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-3",children:e.jsxs("div",{className:"text-sm text-gray-500 text-center",children:['No ingredients or categories found matching "',C,'"']})})]})}function De({ingredient:o,categories:i,onSave:a,onCancel:t,onChange:s}){return e.jsx(re,{isOpen:!0,onClose:t,title:o.id?"Edit Ingredient":"Add New Ingredient",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:o.name,onChange:n=>s("name",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"e.g., Estate 12yr",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Brand"}),e.jsx("input",{type:"text",value:o.brand||"",onChange:n=>s("brand",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"e.g., Appleton (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:o.displayName||"",onChange:n=>s("displayName",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"e.g., Aged Rum (Appleton Estate 12yr)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"ABV %"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:o.abv||"",onChange:n=>s("abv",n.target.value?parseFloat(n.target.value):void 0),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"40.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Category"}),e.jsx(me,{categories:i,onSelect:n=>{n.type==="category"&&n.id&&s("categoryId",n.id)},placeholder:"Select a category...",className:"text-sm",value:o.categoryId&&i.find(n=>n.id===o.categoryId)?.name||"",onClear:()=>s("categoryId",""),showIngredients:!1,showCategories:!0,showCustom:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Description"}),e.jsx("input",{type:"text",value:o.description||"",onChange:n=>s("description",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.available??!0,onChange:n=>s("available",n.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"Available on Menu"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.inStock??!0,onChange:n=>s("inStock",n.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"In Stock"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs("button",{onClick:a,disabled:!o.name.trim(),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 text-sm",children:[o.id?"Update":"Add"," Ingredient"]}),e.jsx("button",{onClick:t,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 text-sm",children:"Cancel"})]})]})})}function Te({isOpen:o,onClose:i,category:a,onSave:t,onChange:s}){return e.jsx(re,{isOpen:o,onClose:i,title:a.parentId?"Add Subcategory":"Add New Category",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Category Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:n=>s("name",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"e.g., Spirits, Jamaican, Aged",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:a.description||"",onChange:n=>s("description",n.target.value),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text text-sm",placeholder:"Brief description of this category"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{onClick:t,disabled:!a.name.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:"Create Category"}),e.jsx("button",{onClick:i,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 text-sm",children:"Cancel"})]})]})})}function Le(){const{categories:o,ingredients:i,isLoadingIngredients:a,error:t,createCategory:s,deleteCategory:n,createIngredient:l,updateIngredient:c,deleteIngredient:u,moveIngredient:x,toggleIngredientAvailability:C,toggleIngredientStock:b,clearError:h}=T(),y=Ee(),[N,k]=j.useState(null),[p,I]=j.useState(null),[A,z]=j.useState(new Set);j.useEffect(()=>{if(t){const f=setTimeout(()=>h(),5e3);return()=>clearTimeout(f)}},[t,h]);const L=(f,w)=>{I(w?{id:w.id,name:w.name,brand:w.brand,displayName:w.displayName,description:w.description,abv:w.abv,available:w.available,inStock:w.inStock,categoryId:w.categoryId}:{name:"",brand:"",displayName:"",description:"",available:!0,inStock:!0,categoryId:f})},R=f=>{k({name:"",description:"",parentId:f})},$=()=>{I(null),k(null)},P=f=>{let w=f.ingredients.length;for(const g of f.children)w+=P(g);return w},G=f=>{z(w=>{const g=new Set(w);return g.has(f)?g.delete(f):g.add(f),g})},D=async()=>{if(!(!p||!p.name.trim()))try{if(p.id){const f=i.find(r=>r.id===p.id);f&&f.categoryId!==p.categoryId&&await x(p.id,p.categoryId);const g={name:p.name.trim(),brand:p.brand?.trim()||"",displayName:p.displayName?.trim()||(p.brand?.trim()?`${p.name.trim()} (${p.brand.trim()})`:p.name.trim()),description:p.description?.trim()||"",available:p.available,inStock:p.inStock,abv:p.abv};await c(p.id,g)}else{const f={name:p.name.trim(),brand:p.brand?.trim()||"",displayName:p.displayName?.trim()||(p.brand?.trim()?`${p.name.trim()} (${p.brand.trim()})`:p.name.trim()),description:p.description?.trim()||"",available:p.available??!0,inStock:p.inStock??!0,abv:p.abv,order:0};await l(p.categoryId,f)}I(null)}catch(f){console.error("Error saving ingredient:",f)}},J=async()=>{if(!(!N||!N.name.trim()))try{await s(N.name.trim(),N.parentId,N.description?.trim()),k(null)}catch(f){console.error("Error saving category:",f)}},_=async f=>{confirm("Are you sure you want to delete this ingredient?")&&await u(f)},V=async f=>{const w=o.find(m=>m.id===f);if(!w)return;const g=o.filter(m=>m.id!==f&&m.path.includes(w.name.toLowerCase())),r=i.filter(m=>m.categoryId===f||g.some(B=>B.id===m.categoryId)),v=g.length>0||r.length>0?`Are you sure you want to delete "${w.name}" and ALL of its ${g.length} subcategories and ${r.length} ingredients? This action cannot be undone.`:`Are you sure you want to delete the category "${w.name}"?`;confirm(v)&&await n(f)},M=({hierarchy:f})=>{const{category:w,children:g,ingredients:r}=f,d=A.has(w.id),v=P(f);return e.jsxs("fieldset",{className:"border-2 border-tiki-carved rounded-lg p-4 mb-4",children:[e.jsxs("legend",{className:"text-lg font-semibold text-tiki-text px-2 bg-tiki-surface flex items-center gap-2",children:[e.jsx("button",{onClick:()=>G(w.id),className:"text-tiki-text hover:text-tiki-accent transition-colors focus:outline-none","aria-label":d?"Expand category":"Collapse category",children:d?"â–¶":"â–¼"}),e.jsxs("span",{className:"flex items-center gap-2",children:[w.name,e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v===0?"bg-gray-100 text-gray-500":"bg-tiki-accent/10 text-tiki-accent"}`,children:[v," ",v===1?"ingredient":"ingredients"]})]}),w.description&&e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",w.description,")"]})]}),!d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>R(w.id),className:"bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700 text-sm",children:"+ Add Subcategory"}),e.jsx("button",{onClick:()=>L(w.id),className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 text-sm",children:"+ Add Ingredient"}),e.jsx("button",{onClick:()=>V(w.id),className:"bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 text-sm",children:"Delete Category"})]}),r.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700",children:"Ingredients:"}),e.jsx("div",{className:"grid gap-2",children:r.map(m=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-tiki-text",children:m.displayName||m.name}),m.brand&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Brand: ",m.brand]}),m.abv&&e.jsxs("p",{className:"text-sm text-gray-600",children:["ABV: ",m.abv,"%"]}),m.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.description}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-1 text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.available,onChange:()=>C(m.id),className:"rounded"}),"Available"]}),e.jsxs("label",{className:"flex items-center gap-1 text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.inStock,onChange:()=>b(m.id),className:"rounded"}),"In Stock"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>L(w.id,m),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>_(m.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Delete"})]})]},m.id))})]}),g.length>0&&r.length>0&&e.jsx("div",{className:"border-t pt-4",children:e.jsx("h4",{className:"font-medium text-sm text-gray-700 mb-2",children:"Subcategories:"})}),g.map(m=>e.jsx(M,{hierarchy:m},m.category.id))]})]})};return e.jsxs("div",{className:"space-y-6",children:[t&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:t}),a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-tiki-accent"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading ingredients..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-tiki-text",children:"Ingredient Library"}),e.jsx("button",{onClick:()=>R(null),className:"bg-tiki-accent text-white px-4 py-2 rounded-md hover:bg-tiki-accent-dark",children:"+ Add Top-Level Category"})]}),y.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No categories yet. Create your first category to get started."}):y.map(f=>e.jsx(M,{hierarchy:f},f.category.id))]}),p&&e.jsx(De,{ingredient:p,categories:o,onSave:D,onCancel:$,onChange:(f,w)=>I(g=>({...g,[f]:w}))}),N&&e.jsx(Te,{isOpen:!0,onClose:$,category:N,onSave:J,onChange:(f,w)=>k(g=>({...g,[f]:w}))})]})}function oe({isOpen:o,onClose:i,onSave:a,recipe:t}){const[s,n]=j.useState({name:"",description:"",category:"Classic Tiki",ingredients:[],instructions:[],active:!0,order:0}),l=ue(),c=Ae(),u=ge(),{createRecipe:x,updateRecipe:C,getCategoryPath:b}=T(),[h,y]=j.useState(!1),[N,k]=j.useState(null),[p,I]=j.useState({amount:0,unit:"oz",customName:"",notes:""}),A=u.filter(r=>r.active).map(r=>r.name),z=["light","medium","strong"],L=["Rocks Glass","Tiki Mug","Hurricane Glass","Coupe","Highball","Collins Glass"],R=["oz","ml","dash","splash","barspoon","drop","pinch"];j.useEffect(()=>{if(o)if(t)n({name:t.name,description:t.description,category:t.category,ingredients:t.ingredients,instructions:t.instructions,servingSize:t.servingSize,garnish:t.garnish,glassType:t.glassType,strength:t.strength,isSpecial:t.isSpecial,isBitter:t.isBitter,active:t.active,order:t.order||0,notes:t.notes});else{const r=u.find(d=>d.active)?.name||"";n({name:"",description:"",category:r,ingredients:[],instructions:[],active:!0,order:0})}},[o,t,u]);const $=()=>{I({amount:0,unit:"oz",customName:"",notes:""}),k(null)},P=()=>{if(!p.amount||p.amount<=0||!N)return;let r;if(N.type==="custom")r={customName:N.name,amount:p.amount,unit:p.unit||"oz",optional:p.optional||!1,notes:p.notes};else if(N.type==="ingredient"&&N.ingredient)r={ingredientId:N.ingredient.id,amount:p.amount,unit:p.unit||"oz",optional:p.optional||!1,notes:p.notes};else if(N.type==="category"&&N.category)r={categoryId:N.category.id,amount:p.amount,unit:p.unit||"oz",optional:p.optional||!1,notes:p.notes};else return;n(d=>({...d,ingredients:[...d.ingredients,r]})),$()},G=r=>{n(d=>({...d,ingredients:d.ingredients.filter((v,m)=>m!==r)}))},D=r=>{if(r.customName)return r.customName;if(r.ingredientId){const d=l.find(v=>v.id===r.ingredientId);return d?.displayName||d?.name||"Unknown ingredient"}return r.categoryId?`Any ${b(r.categoryId)}`:"Unknown ingredient"},J=async()=>{if(!s.name.trim()||s.ingredients.length===0){alert("Please fill in the recipe name and add at least one ingredient.");return}y(!0);try{t?await C(t.id,s):await x(s),a(),i()}catch(r){console.error("Error saving recipe:",r)}finally{y(!1)}},_=()=>{n(r=>({...r,instructions:[...r.instructions,""]}))},V=(r,d)=>{n(v=>({...v,instructions:v.instructions.map((m,B)=>B===r?d:m)}))},M=r=>{n(d=>({...d,instructions:d.instructions.filter((v,m)=>m!==r)}))},f=()=>{n(r=>({...r,garnish:[...r.garnish||[],""]}))},w=(r,d)=>{n(v=>({...v,garnish:(v.garnish||[]).map((m,B)=>B===r?d:m)}))},g=r=>{n(d=>({...d,garnish:(d.garnish||[]).filter((v,m)=>m!==r)}))};return o?e.jsx(re,{isOpen:o,onClose:i,title:t?"Edit Recipe":"Create New Recipe",size:"xl",children:e.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Recipe Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>n(d=>({...d,name:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",placeholder:"e.g., Mai Tai",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Category"}),e.jsx("select",{value:s.category,onChange:r=>n(d=>({...d,category:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",children:A.map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:r=>n(d=>({...d,description:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",rows:2,placeholder:"Brief description of the drink"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Serving Size"}),e.jsx("input",{type:"number",min:"1",value:s.servingSize||1,onChange:r=>n(d=>({...d,servingSize:parseInt(r.target.value)||1})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Strength"}),e.jsxs("select",{value:s.strength||"",onChange:r=>n(d=>({...d,strength:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",children:[e.jsx("option",{value:"",children:"Not specified"}),z.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Glass Type"}),e.jsxs("select",{value:s.glassType||"",onChange:r=>n(d=>({...d,glassType:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",children:[e.jsx("option",{value:"",children:"Not specified"}),L.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.isSpecial||!1,onChange:r=>n(d=>({...d,isSpecial:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"Special Recipe"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.isBitter||!1,onChange:r=>n(d=>({...d,isBitter:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"Contains Bitters"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.active,onChange:r=>n(d=>({...d,active:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"Active"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tiki-text mb-3",children:"Ingredients"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Search Ingredients, Categories, or Add Custom"}),e.jsx(me,{availableIngredients:l,categories:c,onSelect:k,placeholder:"Search ingredients, categories, or type custom...",className:"text-sm",value:N?N.displayName:"",onClear:()=>k(null)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.1",min:"0",value:p.amount||"",onChange:r=>I(d=>({...d,amount:parseFloat(r.target.value)||0})),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm",placeholder:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Unit"}),e.jsx("select",{value:p.unit||"oz",onChange:r=>I(d=>({...d,unit:r.target.value})),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm",children:R.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Notes (optional)"}),e.jsx("input",{type:"text",value:p.notes||"",onChange:r=>I(d=>({...d,notes:r.target.value})),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm",placeholder:"e.g., preferably aged, to taste"})]}),e.jsx("div",{className:"md:col-span-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:p.optional||!1,onChange:r=>I(d=>({...d,optional:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm text-tiki-text",children:"Optional ingredient"})]})}),e.jsx("div",{className:"md:col-span-4",children:e.jsx("button",{type:"button",onClick:P,disabled:!N||!p.amount||p.amount<=0,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 text-sm",children:"Add Ingredient"})})]})}),s.ingredients.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-tiki-text",children:"Recipe Ingredients:"}),s.ingredients.map((r,d)=>e.jsxs("div",{className:"bg-white border border-gray-300 rounded-md p-3 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-tiki-text",children:[r.amount," ",r.unit," ",D(r),r.optional&&e.jsx("span",{className:"text-gray-500 text-sm",children:" (optional)"})]}),r.notes&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:r.notes})]}),e.jsx("button",{type:"button",onClick:()=>G(d),className:"text-red-600 hover:text-red-800 text-sm ml-2",children:"Remove"})]},d))]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tiki-text mb-3",children:"Instructions"}),e.jsxs("div",{className:"space-y-2",children:[s.instructions.map((r,d)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsxs("span",{className:"text-sm text-gray-500 mt-2 min-w-[2rem]",children:[d+1,"."]}),e.jsx("input",{type:"text",value:r,onChange:v=>V(d,v.target.value),className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded-md text-sm",placeholder:"Add instruction step"}),e.jsx("button",{type:"button",onClick:()=>M(d),className:"text-red-600 hover:text-red-800 text-sm px-2 py-2",children:"Ã—"})]},d)),e.jsx("button",{type:"button",onClick:_,className:"bg-blue-600 text-white px-3 py-2 rounded-md hover:bg-blue-700 text-sm",children:"+ Add Instruction"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-tiki-text mb-3",children:"Garnish (optional)"}),e.jsxs("div",{className:"space-y-2",children:[(s.garnish||[]).map((r,d)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"text",value:r,onChange:v=>w(d,v.target.value),className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded-md text-sm",placeholder:"e.g., Lime wheel, Mint sprig"}),e.jsx("button",{type:"button",onClick:()=>g(d),className:"text-red-600 hover:text-red-800 text-sm px-2 py-2",children:"Ã—"})]},d)),e.jsx("button",{type:"button",onClick:f,className:"bg-blue-600 text-white px-3 py-2 rounded-md hover:bg-blue-700 text-sm",children:"+ Add Garnish"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Additional Notes (optional)"}),e.jsx("textarea",{value:s.notes||"",onChange:r=>n(d=>({...d,notes:r.target.value})),className:"w-full px-3 py-2 bg-white border border-tiki-carved rounded-md text-tiki-text",rows:2,placeholder:"Any additional notes about the recipe"})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{onClick:J,disabled:h||!s.name.trim()||s.ingredients.length===0,className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 disabled:opacity-50",children:h?"Saving...":t?"Update Recipe":"Create Recipe"}),e.jsx("button",{onClick:i,className:"bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600",children:"Cancel"})]})]})}):null}function ce({isOpen:o,onClose:i,onSave:a,category:t}){const{createRecipeCategory:s,updateRecipeCategory:n}=T(),[l,c]=j.useState({name:"",description:"",order:0,active:!0}),[u,x]=j.useState(!1);j.useEffect(()=>{c(t?{name:t.name,description:t.description||"",order:t.order,active:t.active}:{name:"",description:"",order:0,active:!0})},[t,o]);const C=async h=>{if(h.preventDefault(),!!l.name.trim()){x(!0);try{t?await n(t.id,{name:l.name.trim(),description:l.description.trim()||void 0,order:l.order,active:l.active}):await s(l.name.trim(),l.description.trim()||void 0,l.order),a()}catch(y){console.error("Error saving category:",y)}finally{x(!1)}}},b=()=>{u||i()};return e.jsx(re,{isOpen:o,onClose:b,title:t?"Edit Category":"Create New Category",size:"sm",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Category Name *"}),e.jsx("input",{type:"text",value:l.name,onChange:h=>c({...l,name:h.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-tiki-accent",placeholder:"e.g., Classic Tiki",required:!0,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:h=>c({...l,description:h.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-tiki-accent",placeholder:"Optional description of this category",rows:3,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-tiki-text mb-1",children:"Display Order"}),e.jsx("input",{type:"number",value:l.order,onChange:h=>c({...l,order:parseInt(h.target.value)||0}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-tiki-accent",min:"0",disabled:u}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first in the list"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"active",checked:l.active,onChange:h=>c({...l,active:h.target.checked}),className:"mr-2",disabled:u}),e.jsx("label",{htmlFor:"active",className:"text-sm text-tiki-text",children:"Active (visible in recipe forms)"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:b,disabled:u,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u||!l.name.trim(),className:"px-4 py-2 bg-tiki-accent text-white rounded-md hover:bg-tiki-accent/90 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Saving...":t?"Update Category":"Create Category"})]})]})})}function Pe({}){const{recipes:o,isLoadingRecipes:i,error:a,deleteRecipe:t,updateRecipe:s,clearError:n,loadRecipeCategories:l,updateRecipeCategory:c,deleteRecipeCategory:u,initializeDefaultRecipeCategories:x}=T(),C=ue(),b=ge(),[h,y]=j.useState(null),[N,k]=j.useState(!1),[p,I]=j.useState(!1),[A,z]=j.useState(null),[L,R]=j.useState(!1),[$,P]=j.useState(!1);j.useEffect(()=>{l()},[l]),j.useEffect(()=>{if(a){const r=setTimeout(()=>n(),5e3);return()=>clearTimeout(r)}},[a,n]);const G=async()=>{I(!0);try{await Y.initializeRecipes()}catch(r){console.error("Error initializing recipes:",r)}finally{I(!1)}},D=async(r,d)=>{confirm(`Are you sure you want to delete "${d}"?`)&&await t(r)},J=async r=>{await s(r.id,{active:!r.active})},_=()=>{y(null),k(!1)},V=async()=>{P(!0);try{await x()}catch(r){console.error("Error initializing categories:",r)}finally{P(!1)}},M=async(r,d)=>{confirm(`Are you sure you want to delete the category "${d}"?`)&&await u(r)},f=()=>{z(null),R(!1)},w=r=>{if(typeof r=="string")return r;if(r.customName)return r.customName;if(r.ingredientId){const d=C.find(v=>v.id===r.ingredientId);return d?.displayName||d?.name||"Unknown ingredient"}if(r.categoryId){const{getCategoryPath:d}=T.getState(),v=d(r.categoryId);return v?`Any ${v}`:"Unknown category"}return"Unknown ingredient"},g=b.reduce((r,d)=>(r[d.name]=o.filter(v=>v.category===d.name),r),{});return o.forEach(r=>{b.find(d=>d.name===r.category)||(g[r.category]||(g[r.category]=[]),g[r.category].push(r))}),i?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-tiki-text",children:"Loading recipes..."})}):a?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"text-red-600 mb-4",children:["Error: ",a]}),e.jsx("button",{onClick:n,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Dismiss"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-tiki-text",children:"Recipe Management"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 text-sm",children:"+ Add Category"}),e.jsx("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 text-sm",children:"+ Create Recipe"}),o.length===0&&e.jsx("button",{onClick:G,disabled:p,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:p?"Initializing...":"Initialize Default Recipes"}),b.length===0&&e.jsx("button",{onClick:V,disabled:$,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:$?"Initializing...":"Initialize Categories"})]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-tiki-text text-lg mb-4",children:"No recipes found"}),e.jsx("p",{className:"text-tiki-text/70 mb-6",children:"Get started by creating your first recipe or initializing with default recipes."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700",children:"Create Your First Recipe"}),e.jsx("button",{onClick:G,disabled:p,className:"bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 disabled:opacity-50",children:p?"Initializing...":"Initialize Default Recipes"})]})]}):e.jsx("div",{className:"space-y-8",children:Object.entries(g).map(([r,d])=>{const v=b.find(m=>m.name===r);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-tiki-text flex items-center gap-2",children:[r,e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-tiki-accent/10 text-tiki-accent",children:[d.length," ",d.length===1?"recipe":"recipes"]}),v&&!v.active&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Inactive"})]}),v&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>c(v.id,{active:!v.active}),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${v.active?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-white hover:bg-gray-700"}`,title:`${v.active?"Deactivate":"Activate"} category`,children:v.active?"âœ“":"âœ—"}),e.jsx("button",{onClick:()=>z(v),className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",title:"Edit category",children:"âœï¸"}),e.jsx("button",{onClick:()=>M(v.id,v.name),className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors",title:"Delete category",children:"ðŸ—‘ï¸"})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-2",children:d.map(m=>e.jsxs("div",{className:"bg-white border border-tiki-carved/30 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-tiki-text text-lg",children:m.name}),e.jsx("p",{className:"text-sm text-tiki-text/80 mt-1",children:m.description})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-3",children:[e.jsx("button",{onClick:()=>J(m),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${m.active?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"}`,title:"Toggle availability",children:m.active?"âœ“":"âœ—"}),e.jsx("button",{onClick:()=>y(m),className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",title:"Edit recipe",children:"âœï¸"}),e.jsx("button",{onClick:()=>D(m.id,m.name),className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",title:"Delete recipe",children:"ðŸ—‘ï¸"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-tiki-text",children:["Ingredients:"," "]}),e.jsx("span",{className:"text-tiki-text/70",children:Array.isArray(m.ingredients)&&m.ingredients.length>0?m.ingredients.map((B,se)=>{const H=w(B);return se===m.ingredients.length-1?H:`${H}, `}):"No ingredients listed"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[m.glassType&&e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:m.glassType}),m.strength&&e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded",children:m.strength}),m.servingSize&&e.jsxs("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded",children:["Serves ",m.servingSize]}),m.isSpecial&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:"Special"}),m.isBitter&&e.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded",children:"Contains Bitters"})]}),Array.isArray(m.instructions)&&m.instructions.length>0&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-tiki-text",children:["Instructions:"," "]}),e.jsx("span",{className:"text-tiki-text/70",children:m.instructions.join(". ").length>100?`${m.instructions.join(". ").substring(0,100)}...`:m.instructions.join(". ")})]})]})]},m.id))})]},r)})}),e.jsx(oe,{isOpen:N,onClose:()=>k(!1),onSave:_,recipe:null}),e.jsx(oe,{isOpen:!!h,onClose:()=>y(null),onSave:_,recipe:h}),L&&e.jsx(ce,{isOpen:L,onClose:()=>R(!1),onSave:f,category:null}),A&&e.jsx(ce,{isOpen:!!A,onClose:()=>z(null),onSave:f,category:A})]})}function Fe(){return ze()?e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:e.jsx("div",{className:"h-1 bg-tiki-accent/20",children:e.jsx("div",{className:"h-full bg-tiki-accent animate-progress-indeterminate"})})}):null}function Oe(){const{currentUser:o,logout:i}=le(),[a,t]=j.useState(!1),[s,n]=j.useState("inventory"),{loadIngredientLibrary:l,loadRecipes:c}=T();j.useEffect(()=>{if(!o){t(!0);return}l(),c()},[o,l,c]);const u=async()=>{try{await i(),t(!0)}catch(x){console.error("Error logging out:",x)}};return!o&&a?e.jsx(be,{onClose:()=>t(!1)}):o?e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"tiki-container",children:e.jsxs("div",{className:"max-w-6xl mx-auto p-6 md:p-12",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-tiki-text",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-tiki-text",children:["Welcome, ",o.email]}),e.jsx("button",{onClick:u,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"Logout"})]})]}),e.jsxs("div",{className:"bg-tiki-surface rounded-lg border border-tiki-carved overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-tiki-carved/30",children:[e.jsx("button",{onClick:()=>n("inventory"),className:`flex-1 px-6 py-4 font-medium transition-colors ${s==="inventory"?"bg-tiki-accent text-white":"text-tiki-text hover:bg-tiki-surface/50"}`,children:"Inventory Management"}),e.jsx("button",{onClick:()=>n("recipes"),className:`flex-1 px-6 py-4 font-medium transition-colors ${s==="recipes"?"bg-tiki-accent text-white":"text-tiki-text hover:bg-tiki-surface/50"}`,children:"Recipe Management"})]}),e.jsxs("div",{className:"p-6",children:[s==="inventory"&&e.jsx(Le,{}),s==="recipes"&&e.jsx(Pe,{})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("a",{href:"/tiki-menu/",className:"inline-block bg-tiki-accent text-white px-6 py-3 rounded-md hover:bg-opacity-90 transition-colors",children:"Back to Menu"})})]})}),e.jsx(Fe,{})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-tiki-text mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-tiki-text mb-4",children:"You must be logged in to access this page."}),e.jsx("button",{onClick:()=>t(!0),className:"bg-tiki-accent text-white px-4 py-2 rounded-md hover:bg-opacity-90",children:"Login"})]})})}const $e=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"})),Je={serverOnlyHooks:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:fe}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/admin/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:$e}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/pages/+Layout.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"plus-file",exportValues:ye}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/admin/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Admin Dashboard - Tiki Bar"}},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:xe}}};export{Je as configValuesSerialized};
